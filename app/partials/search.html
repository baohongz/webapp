<!-- search app / results -->

<div>
    <!-- <h3 view-title>Search results for {{(search.query.q.title || search.query.q)}}</h3>
    <div class="h6">Found {{search.results.total || 0}} results <span ng-show="search.results.took!==undefined">({{search.results.took/1000}} seconds)</span></div> -->
    <cttv-page-progress-spinner></cttv-page-progress-spinner>

    <div class="cttv-content-header">
        <h3 view-title>Search results for {{(search.query.q.title || search.query.q)}}</h3>
        <p>Found {{search.results.total || 0}} results<span class="cttv-interpage-link text-lowlight" ng-show="search.results.took!==undefined"><span class="small">{{search.results.took/1000}} seconds</span></span>
        </p>
    </div>

    <div class="row">

        <!-- Filters/Facets -->

        <div class="col-sm-2">
            <h4>Refine by:</h4>
            <div class="checkbox">
                <label ng-class="(filters.target.total==0) ? 'text-lowlight' : ''"><input type="checkbox" ng-model="filters.target.selected" ng-change="getResults()" ng-disabled="filters.target.total==0">Target <span class='badge badge-primary'>{{filters.target.total}}</span></label>
                <span cttv-progress-spinner class="text-lowlight" ng-show="filters.target.loading"></span>
            </div>
            <div class="checkbox">
                <label ng-class="(filters.disease.total==0) ? 'text-lowlight' : ''"><input type="checkbox" ng-model="filters.disease.selected" ng-change="getResults()" ng-disabled="filters.disease.total==0">Disease <span class='badge badge-warning'>{{filters.target.total}}</span></label>
                <span cttv-progress-spinner class="text-lowlight" ng-show="filters.disease.loading"></span>
            </div>
        </div>

        <!-- Search results -->


        <div class="col-sm-10">

            <div ng-class="search.loading ? 'opacity-50' : ''">
                <div ng-repeat="result in search.results.data" class="search-result">
                    <h4><a ng-href="/{{result.data.type}}/{{result.data.id}}/associations">{{result.data.name}}</a> <span style="font-size: 0.8em; color:#888888"> {{result.data.association_counts.direct}} {{result.data.type == "target" ? (result.data.association_counts.direct == 1 ? "disease" : "diseases") : (result.data.association_counts.direct == 1 ? "target" : "targets")}} associated</span></h4>
                    <span class="search-description">{{result.data.description | limitTo: 300 }}<span ng-show="result.data.description.length>300">...</span></span>
                    <span class="search-matches text-lowlight">
                        <span ng-repeat="(key, val) in result.highlight"><span bind-html-unsafe="'<span style=\'color:#888\' title=\'Matching field and text\'>' + ( !$first ? ' ... ' : '') + key.split('_').join(' ') + ': </span>' + val.join(', ')"></span></span>
                    </span>

                    <span class="search-details">
                        <span class="label" ng-class="(result.data.type==='target') ? 'label-primary' : 'label-warning'">{{result.data.type}}</span><!-- &nbsp;|&nbsp;<span class="text-lowlight">Score: {{result.score}}</span> -->
                    </span>
                </div>
            <div>


            <!-- Furthermore this should only be shown when results are displayed -->
            <pagination boundary-links="true" total-items="search.results.total" ng-model="search.query.page" direction-links="true" class="pagination-sm" items-per-page="search.query.size" max-size=10 ng-change="getResults();" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" num-pages="numPages" style="{{numPages<=1 ? 'display:none' : ''}}"></pagination>
        </div>

    </div>





</div>
<!-- end search results-->
